<!DOCTYPE HTML>
<html>
<head>
<title>1 FILE SOKOBAN!!!</title>
<script> 
/*------------------------------------------------------------------------------ 
Copyright (c) 2011 Antoine Santo Aka NoNameNo

This File is part of the CODEF project.

More info : http://codef.santo.fr
Demo gallery http://www.wab.com

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
------------------------------------------------------------------------------*/
</script>
<script>
window.requestAnimFrame = (function(){
	return  window.requestAnimationFrame       || 
		window.webkitRequestAnimationFrame || 
		window.mozRequestAnimationFrame    || 
		window.oRequestAnimationFrame      || 
		window.msRequestAnimationFrame     || 
		function(/* function */ callback, /* DOMElement */ element){
			window.setTimeout(callback, 1000 / 60);
		};
})();

/**
        <b>Create a new canvas object.</b><br>
	canvas(w, h, divname)<br>

        @class canvas
        @param {Number in pixel} w The Width of the canvas you want to create.
        @param {Number in pixel} h The Height of the canvas you want to create.
        @param {String} [divname] The div id you want the create the canvas to. If not specified, the canvas will be hidden.
	@property {Number in pixel} width The Width of the canvas.
	@property {Number in pixel} height The Height of the canvas.
	@property {Object} canvas object of this canvas. ;)
	@property {Object} contex the 2d context of this canvas.
	@property {Number in pixel} handlex the x coord of the handle (0 by default).
	@property {Number in pixel} handley the y coord of the handle (0 by default).
	@property {Number in pixel} tilew the Width of a tile (IF this canvas is a tileset).
	@property {Number in pixel} tileh the Height of a tile (IF this canvas is a tileset).
	@property {Number} tilestart the number of the first tile (usefull for tileset like font).
	@example
	var mycanvas = new canvas(640, 480, "main");
	
*/
function canvas(w, h, divname){
	this.width=w;
	this.height=h;
	this.canvas;
	this.contex;
	this.canvas = document.createElement("canvas");
	if(divname) document.getElementById(divname).appendChild(this.canvas);
	this.canvas.setAttribute('width', w);
	this.canvas.setAttribute('height', h);
	this.canvas.id="maincanvas";
	this.contex = this.canvas.getContext('2d');
	
	this.handlex=0;
        this.handley=0;
	this.midhandled=false;
	this.tilew=0;
	this.tileh=0;
	this.tilestart=0;
	
	/**
                <b>Fill the canvas.</b><br>
		canvas.fill(color)<br>

                @function canvas.fill
                @param {Color} color The color you want to fill the canvas with.
		@example
		mycanvas.fill('#FF0000');
        */
	this.fill = function(color){
		var tmp = this.contex.fillStyle;
		var tmp2= this.contex.globalAlpha;
		this.contex.globalAlpha=1;
		this.contex.fillStyle = color;
		this.contex.fillRect (0, 0, this.canvas.width, this.canvas.height);
		this.contex.fillStyle = tmp
		this.contex.globalAlpha=tmp2;
	}

	/**
                <b>Clear the canvas.</b><br>

                @function canvas.clear
		@example
		mycanvas.clear();
        */
	this.clear = function(){
		this.contex.clearRect (0, 0, this.canvas.width, this.canvas.height);
	}
	
	/**
                <b>Draw a plot on the canvas.</b><br>
		canvas.plot(x1,y1,width,color)<br>

                @function canvas.plot
                @param {Number in pixel} x The x coord you want to plot in the canvas.
                @param {Number in pixel} y The y coord you want to plot in the canvas.
                @param {Number in pixel} width The size of the plot.
                @param {Color} color The color of the plot.
		@example
		mycanvas.plot(20,20,50,'#FF0000');
        */
	this.plot = function(x,y,width,color){
		// save old fillstyle
		var oldcolor = this.contex.fillStyle ;

		this.contex.fillStyle=color;
		this.contex.fillRect(x,y,width,width) ;

		// restore old fillstyle
		this.contex.fillStyle=oldcolor;
	}
	
	/**
                <b>Draw a line on the canvas.</b><br>
		canvas.line(x1,y1,x2,y2,width,color)<br>

                @function canvas.line
                @param {Number in pixel} x1 The x coord of the line start in the canvas.
                @param {Number in pixel} y1 The y coord of the line start in the canvas.
                @param {Number in pixel} x2 The x coord of the line end in the canvas.
                @param {Number in pixel} y2 The y coord of the line end in the canvas.
                @param {Number in pixel} width The width of the line.
                @param {Color} color The color of the plot.
		@example
		mycanvas.line(0,0,50,50,2,'#FF0000');
        */
	this.line = function(x1,y1,x2,y2,width,color){
		var tmp=this.contex.strokeStyle;
		this.contex.strokeStyle=color;
		this.contex.lineWidth=width;
		this.contex.beginPath();
		this.contex.moveTo(x1,y1);
		this.contex.lineTo(x2,y2);
		this.contex.stroke();
		this.contex.closePath();
		this.contex.strokeStyle=tmp;
	}
	
	/**
                <b>Draw a filled triangle on the canvas.</b><br>
		canvas.triangle(x1,y1,x2,y2,x3,y3,color)<br>

                @function canvas.triangle
                @param {Number in pixel} x1 The x coord of the 1st edge of the triangle in the canvas.
                @param {Number in pixel} y1 The y coord of the 1st edge of the triangle in the canvas.
                @param {Number in pixel} x2 The x coord of the 2nd edge of the triangle in the canvas.
                @param {Number in pixel} y2 The y coord of the 2nd edge of the triangle in the canvas.
                @param {Number in pixel} x3 The x coord of the 3rd edge of the triangle in the canvas.
                @param {Number in pixel} y3 The y coord of the 3rd edge of the triangle in the canvas.
                @param {Color} color The color of the plot.
		@example
		mycanvas.triangle(150,150,250,250,50,250,'#FF0000');
        */
	this.triangle = function(x1,y1,x2,y2,x3,y3,color){
		this.contex.beginPath();
		this.contex.moveTo(x1,y1);
		this.contex.lineTo(x2,y2);
		this.contex.lineTo(x3,y3);
		this.contex.closePath();
		this.contex.fillStyle=color;
		this.contex.fill();
	}

	/**
                <b>Draw a filled quad on the canvas.</b><br>
                <br>
		it can be used with 5 params : <br>
		canvas.quad(x1,y1,w,h,color)<br>
		<br>
		or it can be used with 9 params : <br>
                canvas.quad(x1,y1,x2,y2,x3,y3,x4,y4,color)<br>
                @function canvas.quad
                @param {Number in pixel} x1 The x coord of the 1st edge of the quad in the canvas.
                @param {Number in pixel} y1 The y coord of the 1st edge of the quad in the canvas.
                @param {Number in pixel} x2 The x coord of the 2nd edge of the quad in the canvas.
                @param {Number in pixel} y2 The y coord of the 2nd edge of the quad in the canvas.
                @param {Number in pixel} x3 The x coord of the 3rd edge of the quad in the canvas.
                @param {Number in pixel} y3 The y coord of the 3rd edge of the quad in the canvas.
                @param {Number in pixel} x4 The x coord of the 4th edge of the quad in the canvas.
                @param {Number in pixel} y4 The y coord of the 4th edge of the quad in the canvas.
                @param {Number in pixel} w The Width of the quad in the canvas.
                @param {Number in pixel} h The Height of the quad in the canvas.
                @param {Color} color The color of the plot.
		@example
		mycanvas.quad(150,150,250,250,'#FF0000');
		or
		mycanvas.quad(0,150,300,150,250,250,50,250,'#FF0000');
        */
	this.quad = function(x1,y1,x2,y2,x3,y3,x4,y4,color){
		// save old fillstyle
		var oldcolor = this.contex.fillStyle ;

		// if x1 y1 width height color
		if(arguments.length==5){
			this.contex.fillStyle=x3;
			this.contex.fillRect(x1,y1,x2,y2) ;
		}
		// if all quad coordinates
		else{
			this.contex.beginPath();
			this.contex.moveTo(x1,y1);
			this.contex.lineTo(x2,y2);
			this.contex.lineTo(x3,y3);
			this.contex.lineTo(x4,y4);
			this.contex.closePath();
			this.contex.fillStyle=color;
			this.contex.fill();		
		}
		// restore old fillstyle
		this.contex.fillStyle=oldcolor;
	}	
	
	/**
                <b>Init a tileset canvas.</b><br>
                canvas.initTile(tilew,tileh, tilestart)<br>

                @function canvas.initTile
                @param {Number in pixel} tilew The Width of one tile.
                @param {Number in pixel} tileh The Height of one tile.
                @param {Number} [tilestart] The number of the first tile. (0 by default)
		@example
		mycanvas.initTile(32,32);
        */
	this.initTile=function(tilew,tileh, tilestart){
		this.tileh=tileh;
		this.tilew=tilew;
		if(typeof(tilestart)!='undefined')
			this.tilestart=tilestart;
	}
	
	/**
                <b>Draw the canvas to another canvas.</b><br>
                canvas.draw(dst,x,y,alpha, rot,w,h)<br>

                @function canvas.draw
		@param {Object} dst The destination canvas.
                @param {Number in pixel} x The x coord in the destination canvas (based on the handle coord).
                @param {Number in pixel} y The y coord in the destination canvas (based on the handle coord).
                @param {Number} [alpha] The normalized value of the alpha (1 by default).
		@param {Number} [rot] The rotation angle in degrees (0 by default) (will use the handle coord as rotation axis).
		@param {Number} [w] The normalized zoom factor on x (1 by default).
		@param {Number} [h] The normalized zoom factor on y (1 by default).
		@example
		mycanvas.draw(destcanvas,10,10,1,0,1,1);
        */
        this.draw = function(dst,x,y,alpha, rot,w,h){
                var tmp=dst.contex.globalAlpha;
		if(typeof(alpha)=='undefined') alpha=1;
                dst.contex.globalAlpha=alpha;
                if(arguments.length==3 || arguments.length==4)
                        dst.contex.drawImage(this.canvas, x-this.handlex,y-this.handley);
		else if(arguments.length==5){
			dst.contex.translate(x,y);
                        dst.contex.rotate(rot*Math.PI/180);
                        dst.contex.translate(-this.handlex,-this.handley);
                        dst.contex.drawImage(this.canvas, 0,0);
                        dst.contex.setTransform(1, 0, 0, 1, 0, 0);
		}
                else{
                        dst.contex.translate(x,y);
                        dst.contex.rotate(rot*Math.PI/180);
                        dst.contex.scale(w,h);
                        dst.contex.translate(-this.handlex,-this.handley);
                        dst.contex.drawImage(this.canvas, 0,0);
                        dst.contex.setTransform(1, 0, 0, 1, 0, 0);
                }
                dst.contex.globalAlpha=tmp;
        }
        
	/**
                <b>Draw a tile from this canvas to another canvas.</b><br>
                canvas.drawTile(dst, nb, x, y, alpha, rot, w, h)<br>

                @function canvas.drawTile
                @param {Object} dst The destination canvas.
		@param {Number} nb the tile number.
                @param {Number in pixel} x The x coord in the destination canvas (based on the handle coord).
                @param {Number in pixel} y The y coord in the destination canvas (based on the handle coord).
                @param {Number} [alpha] The normalized value of the alpha (1 by default).
                @param {Number} [rot] The rotation angle in degrees (0 by default) (will use the handle coord as rotation axis).
                @param {Number} [w] The normalized zoom factor on x (1 by default).
                @param {Number} [h] The normalized zoom factor on y (1 by default).
		@example
		mycanvas.drawTile(destcanvas,5,10,10,1,0,1,1);
        */
        this.drawTile = function(dst, nb, x, y, alpha, rot, w, h){
		var tmp=dst.contex.globalAlpha;
		if(typeof(alpha)=='undefined') alpha=1;
                dst.contex.globalAlpha=alpha;
                this.drawPart(dst,x,y,Math.floor((nb%(this.canvas.width/this.tilew)))*this.tilew,Math.floor(nb/(this.canvas.width/this.tilew))*this.tileh,this.tilew,this.tileh,alpha, rot, w, h);
		dst.contex.globalAlpha=tmp;

	}
        
	/**
                <b>Draw a part of this canvas to another canvas.</b><br>
                canvas.drawPart(dst,x,y,partx,party,partw,parth,alpha, rot,zx,zy)<br>

                @function canvas.drawPart
                @param {Object} dst The destination canvas.
                @param {Number in pixel} x The x coord in the destination canvas (based on the handle coord).
                @param {Number in pixel} y The y coord in the destination canvas (based on the handle coord).
		@param {Number in pixel} partx The x coord of the part in the source canvas.
		@param {Number in pixel} party The y coord of the part in the source canvas.
		@param {Number in pixel} partw The width of the part in the source canvas.
		@param {Number in pixel} parth The height of the part in the source canvas.
                @param {Number} [alpha] The normalized value of the alpha (1 by default).
                @param {Number} [rot] The rotation angle in degrees (0 by default) (will use the handle coord as rotation axis).
                @param {Number} [zx] The normalized zoom factor on x (1 by default).
                @param {Number} [zy] The normalized zoom factor on y (1 by default).
		@example
		mycanvas.drawTile(mycanvas,10,10,0,0,50,50,1,0,1,1);
        */
        this.drawPart = function(dst,x,y,partx,party,partw,parth,alpha, rot,zx,zy){
        	if(partx<0) {
        		x-=partx/(this.midhandled==true?2:1);
        		partw+=partx;
        		partx=0;
            } else {
                if (this.midhandled==false) {
                    partw = Math.min(partw,this.width-partx);
                }
        	}
        	if(party<0) {
        		y-=party/(this.midhandled==true?2:1);
        		parth+=party;
        		party=0;
            } else {
                if (this.midhandled==false) {
                    parth = Math.min(parth,this.height-party);
                }
        	}
        	if(partw<=0 || parth<=0){
        		return;
        	}
                var tmp=dst.contex.globalAlpha;
		if(typeof(alpha)=='undefined') alpha=1;
                dst.contex.globalAlpha=alpha;
                if(arguments.length==7 || arguments.length==8){
                       	dst.contex.translate(x,y);
			if(this.midhandled==true) dst.contex.translate(-partw/2,-parth/2); else dst.contex.translate(-this.handlex,-this.handley);
			dst.contex.drawImage(this.canvas,partx,party,partw,parth,0,0,partw,parth);
			dst.contex.setTransform(1, 0, 0, 1, 0, 0);
		}
		else if(arguments.length==9){
                       	dst.contex.translate(x,y);
			dst.contex.rotate(rot*Math.PI/180);
			if(this.midhandled==true) dst.contex.translate(-partw/2,-parth/2); else dst.contex.translate(-this.handlex,-this.handley);
			dst.contex.drawImage(this.canvas,partx,party,partw,parth,0,0,partw,parth);
			dst.contex.setTransform(1, 0, 0, 1, 0, 0);
		}
                else{
                       	dst.contex.translate(x,y);
			dst.contex.rotate(rot*Math.PI/180);
			dst.contex.scale(zx,zy);
			if(this.midhandled==true) dst.contex.translate(-partw/2,-parth/2); else dst.contex.translate(-this.handlex,-this.handley);
			dst.contex.drawImage(this.canvas,partx,party,partw,parth,0,0,partw,parth);
			dst.contex.setTransform(1, 0, 0, 1, 0, 0);
                }
                dst.contex.globalAlpha=tmp;
        }

	 /**
                <b>Set the handle coord of this canvas to the center.</b><br>

                @function canvas.setmidhandle
		@example
		mycanvas.setmidhandle();
        */
	this.setmidhandle=function(){
                this.handlex=parseInt(this.canvas.width/2);
                this.handley=parseInt(this.canvas.height/2);
		this.midhandled=true;
        }

	/**
                <b>Set the handle of the canvas.</b><br>
                canvas.sethandle(x,y)<br>

                @function canvas.sethandle
                @param {Number in pixel} x The x coord of the handle of the canvas.
                @param {Number in pixel} y The y coord of the handle of the canvas.
		@example
		mycanvas.sethandle(50,50);
        */
        this.sethandle=function(x,y){
                this.handlex=x;
                this.handley=y;
		this.midhandled=false;
        }
        
        this.print=function(dst, str, x, y, alpha, rot, w, h){
		for(var i=0; i<str.length; i++){
			if(typeof(w)!='undefined')
				this.drawTile(dst, str[i].charCodeAt(0)-this.tilestart,x+i*this.tilew*w,y,alpha,rot,w,h);
			else
				this.drawTile(dst, str[i].charCodeAt(0)-this.tilestart,x+i*this.tilew,y,alpha,rot,w,h);
		}
	}

	
	return this;
	
}


/**
        <b>Create an image object and load a remote/local png/gif/jpg in it.</b><br>
        image(img)<br>

        @class image
        @param {string} img local or url to an jpg/png/gif image.
        @property {Object} img the dom image object.
        @property {Number in pixel} handlex the x coord of the handle (0 by default).
        @property {Number in pixel} handley the y coord of the handle (0 by default).
        @property {Number in pixel} tilew the Width of a tile (IF this canvas is a tileset).
        @property {Number in pixel} tileh the Height of a tile (IF this canvas is a tileset).
        @property {Number} tilestart the number of the first tile (usefull for tileset like font).
	@example
	// with a local file
	var mylogo = new image('logo.png');

	// with a remote image
	var mylogo = new image('http://www.myremotesite.com/logo.png');

*/
function image(img){
	this.img = new Image();
	this.img.src=img;
        this.handlex=0;
        this.handley=0;
	this.midhandled=false;
	this.tilew=0;
	this.tileh=0;
	this.tilestart=0;
	
	/**
                <b>Init a tileset image.</b><br>
                image.initTile(tilew,tileh, tilestart)<br>

                @function image.initTile
                @param {Number in pixel} tilew The Width of one tile.
                @param {Number in pixel} tileh The Height of one tile.
                @param {Number} [tilestart] The number of the first tile. (0 by default)
		@example
		myimage.initTile(32,32);
        */
	this.initTile=function(tilew,tileh,tilestart){
		this.tileh=tileh;
		this.tilew=tilew;
		if(typeof(tilestart)!='undefined')
			this.tilestart=tilestart;
			
	}

/**
                <b>Draw the image to a canvas.</b><br>
                image.draw(dst,x,y,alpha, rot,w,h)<br>

                @function image.draw
                @param {Object} dst The destination canvas.
                @param {Number in pixel} x The x coord in the destination canvas (based on the handle coord of the image).
                @param {Number in pixel} y The y coord in the destination canvas (based on the handle coord of the image).
                @param {Number} [alpha] The normalized value of the alpha (1 by default).
                @param {Number} [rot] The rotation angle in degrees (0 by default) (will use the handle coord as rotation axis).
                @param {Number} [w] The normalized zoom factor on x (1 by default).
                @param {Number} [h] The normalized zoom factor on y (1 by default).
		@example
		myimage.draw(destcanvas,10,10,1,0,1,1);
        */
        this.draw = function(dst,x,y,alpha, rot,w,h){
                var tmp=dst.contex.globalAlpha;
		if(typeof(alpha)=='undefined') alpha=1;
                dst.contex.globalAlpha=alpha;
                if(arguments.length==3 || arguments.length==4)
                        dst.contex.drawImage(this.img, x-this.handlex,y-this.handley);
		else if(arguments.length==5){
			dst.contex.translate(x,y);
                        dst.contex.rotate(rot*Math.PI/180);
                        dst.contex.translate(-this.handlex,-this.handley);
                        dst.contex.drawImage(this.img, 0,0);
                        dst.contex.setTransform(1, 0, 0, 1, 0, 0);
		}
                else{
                        dst.contex.translate(x,y);
                        dst.contex.rotate(rot*Math.PI/180);
                        dst.contex.scale(w,h);
                        dst.contex.translate(-this.handlex,-this.handley);
                        dst.contex.drawImage(this.img, 0,0);
                        dst.contex.setTransform(1, 0, 0, 1, 0, 0);
                }
                dst.contex.globalAlpha=tmp;
        }
        
	/**
                <b>Draw a tile from this image to a canvas.</b><br>
                image.drawTile(dst, nb, x, y, alpha, rot, w, h)<br>

                @function image.drawTile
                @param {Object} dst The destination canvas.
                @param {Number} nb the tile number.
                @param {Number in pixel} x The x coord in the destination canvas (based on the handle coord of the image).
                @param {Number in pixel} y The y coord in the destination canvas (based on the handle coord of the image).
                @param {Number} [alpha] The normalized value of the alpha (1 by default).
                @param {Number} [rot] The rotation angle in degrees (0 by default) (will use the handle coord as rotation axis).
                @param {Number} [w] The normalized zoom factor on x (1 by default).
                @param {Number} [h] The normalized zoom factor on y (1 by default).
		@example
		myimage.drawTile(destcanvas,5,10,10,1,0,1,1);
        */
        this.drawTile = function(dst, nb, x, y, alpha, rot, w, h){
		var tmp=dst.contex.globalAlpha;
		if(typeof(alpha)=='undefined') alpha=1;
                dst.contex.globalAlpha=alpha;
                this.drawPart(dst,x,y,Math.floor((nb%(this.img.width/this.tilew)))*this.tilew,Math.floor(nb/(this.img.width/this.tilew))*this.tileh,this.tilew,this.tileh,alpha, rot, w, h);
		dst.contex.globalAlpha=tmp;

	}
        
	/**
                <b>Draw a part of this image to a canvas.</b><br>
                image.drawPart(dst,x,y,partx,party,partw,parth,alpha, rot,zx,zy)<br>

                @function image.drawPart
                @param {Object} dst The destination canvas.
                @param {Number in pixel} x The x coord in the destination canvas (based on the handle coord of the image).
                @param {Number in pixel} y The y coord in the destination canvas (based on the handle coord of the image).
                @param {Number in pixel} partx The x coord of the part in the source canvas.
                @param {Number in pixel} party The y coord of the part in the source canvas.
                @param {Number in pixel} partw The width of the part in the source canvas.
                @param {Number in pixel} parth The height of the part in the source canvas.
                @param {Number} [alpha] The normalized value of the alpha (1 by default).
                @param {Number} [rot] The rotation angle in degrees (0 by default) (will use the handle coord as rotation axis).
                @param {Number} [zx] The normalized zoom factor on x (1 by default).
                @param {Number} [zy] The normalized zoom factor on y (1 by default).
		@example
		myimage.drawTile(mycanvas,10,10,0,0,50,50,1,0,1,1);
        */
        this.drawPart = function(dst,x,y,partx,party,partw,parth,alpha, rot,zx,zy){
        	if(partx<0) {
        		x-=partx/(this.midhandled==true?2:1);
        		partw+=partx;
        		partx=0;
            } else {
                if (this.midhandled==false) {
                    partw = Math.min(partw,this.img.width-partx);
                }
        	}
        	if(party<0) {
        		y-=party/(this.midhandled==true?2:1);
        		parth+=party;
        		party=0;
            } else {
                if (this.midhandled==false) {
                    parth = Math.min(parth,this.img.height-party);
                }
        	}
        	if(partw<=0 || parth<=0){
        		return;
        	}
                var tmp=dst.contex.globalAlpha;
		if(typeof(alpha)=='undefined') alpha=1;
                dst.contex.globalAlpha=alpha;
                if(arguments.length==7 || arguments.length==8){
                       	dst.contex.translate(x,y);
			if(this.midhandled==true) dst.contex.translate(-partw/2,-parth/2); else dst.contex.translate(-this.handlex,-this.handley);
			dst.contex.drawImage(this.img,partx,party,partw,parth,null,null,partw,parth);
			dst.contex.setTransform(1, 0, 0, 1, 0, 0);
		}
		else if(arguments.length==9){
                       	dst.contex.translate(x,y);
			dst.contex.rotate(rot*Math.PI/180);
			if(this.midhandled==true) dst.contex.translate(-partw/2,-parth/2); else dst.contex.translate(-this.handlex,-this.handley);
			dst.contex.drawImage(this.img,partx,party,partw,parth,null,null,partw,parth);
			dst.contex.setTransform(1, 0, 0, 1, 0, 0);
		}
                else{
                       	dst.contex.translate(x,y);
			dst.contex.rotate(rot*Math.PI/180);
			dst.contex.scale(zx,zy);
			if(this.midhandled==true) dst.contex.translate(-partw/2,-parth/2); else dst.contex.translate(-this.handlex,-this.handley);
			dst.contex.drawImage(this.img,partx,party,partw,parth,null,null,partw,parth);
			dst.contex.setTransform(1, 0, 0, 1, 0, 0);
                }
                dst.contex.globalAlpha=tmp;
        }
        
        
	
	/**
                <b>Set the handle coord of this image to the center.</b><br>

                @function image.setmidhandle
		@example
		myimage.setmidhandle();
        */
	this.setmidhandle=function(){
                this.handlex=parseInt(this.img.width/2);
                this.handley=parseInt(this.img.height/2);
		this.midhandled=true;
        }

	/**
                <b>Set the handle of the image.</b><br>
                image.sethandle(x,y)<br>

                @function image.sethandle
                @param {Number in pixel} x The x coord of the handle of the image.
                @param {Number in pixel} y The y coord of the handle of the image.
		@example
		myimage.sethandle(50,50);
        */
        this.sethandle=function(x,y){
                this.handlex=x;
                this.handley=y;
		this.midhandled=false;
        }
        
        this.print=function(dst, str, x, y, alpha, rot, w, h){
		for(var i=0; i<str.length; i++){
			if(typeof(w)!='undefined')
				this.drawTile(dst, str[i].charCodeAt(0)-this.tilestart,x+i*this.tilew*w,y,alpha,rot,w,h);
			else
				this.drawTile(dst, str[i].charCodeAt(0)-this.tilestart,x+i*this.tilew,y,alpha,rot,w,h);
		}
	}

	return this;
}

</script>
<script>
/* +=======================================================+ */
/* | SokoWABan - A CODEF 4K Sokoban clone                  | */
/* +-------------------------------------------------------+ */
/* | A CODEF submission for the WAB Contest #1             | */
/* | Released on june 30 2016                              | */
/* | Credits :                                             | */
/* |   - Code  : Dyno                                      | */
/* |   - Music : Tiny Skweeks by Moby                      | */
/* | More info on https://www.facebook.com/groups/codef/   | */
/* +-------------------------------------------------------+ */
/* | Copyleft 2016 by Dyno <dyno@aldabase.com>             | */
/* +=======================================================+ */

// ==ClosureCompiler==
// http://closure-compiler.appspot.com/home
// @compilation_level ADVANCED_OPTIMIZATIONS
// @output_file_name index.js
// @output_format text
// @output_info compiled_code
// @externs_url http://live.aldabase.com/2016/wab-contest-os/closure/codef_core.js
// @externs_url http://live.aldabase.com/2016/wab-contest-os/closure/codef_music.js
// ==/ClosureCompiler==

// Declared functions
var game_controller,
    game_init_level,
    game_display_map,
    game_direction,
    game_next_level,
    main_init_canvas,
    main_number_format,
    map_check_end_of_game,
    map_is_box,
    map_is_empty,
    map_is_destination,
    modal_view,
    sprite_draw,
    sprite_direction,
    sprite_move,
    sprite_push_or_pull,
    statusbar_game,
    unpack_levels;

// Global variables
var current_level = 0,
    allow_move = 1,
    current_move,
    current_push,
    canvas_w = 25,
    canvas_h = 18,
    sprite_w = 32,
    sprite_h = 32,
    shadow_w = 8,
    displayzone,
    displaygnd,
    displaysha,
    displaymap,
    displayobj,
    pos_x,
    pos_y,
    map,
    map_width,
    map_height,
    map_obj,
    doc,
    doc_main,
    tmp,
    // Pictures
    picture = [];

var levels_length = 20,
    levels = [
        "cjAc393Ac393A4b97w43l3wb1317138n393171j5633V63j1b1317563c3hzcrs|jb8527354742757",                          // Thinking_Rabbit #1
        "8bg47130f075b537t33l353b5b5343536530717231703l7003h740r8|b44335445",                                       // Sasquatch #1
        "070j7171213317521307h37db3d74361707393070j034|94452433425",                                                // Sasquatch #2
        "Aj0A793A3d3cf4397c35f930c3x308717l3083523l3083523l30j1z03ed3k3ed3k75nk0fE|g6ac3b4d4a5c596b6d6a7c7",        // Sasquatch #3
        "r3h33525336363352533h3r|732224223432444",                                                                  // Puzzle #4
        "L43653hb3653p336531f5336l753365313d7n17d343B343d3h34L|e7472a263a596b6477797b7",                            // Thinking_Rabbit #2
        "4H07h393bh393317t3353d393n1n361653270316db4356j8zc|db14262724393a3646696",                                 // Sasquatch #4
        "En4cf47d344b5343571bbdf13h33lmh33l71b9bb1b931j403lbs039fA0jM|j54g334a4f42545",                             // Sasquatch #7
        "cr4c3h70j1b573p35735e1753353d71237575393075f212347t38n57sf0|d1424344454a4a6a7",                            // Sasquatch #8
        "n0353273d233h335363r|71422324233",                                                                         // Puzzle #3
        "sv0s3l30s353570s3h34s7d34z931b3e57p37aF33e5Dvw|he1a2c2a3d3a4c4a5a6d697c7",                                 // Thinking_Rabbit #3
        "z3212d33212125371b5303h703d7003d34035b40fc|9632244354546",                                                 // Sasquatch #9
        "4fgb5f43p7031321232b3x3b2323231307p34f5bgf4|b42243444647484",                                              // Sasquatch #11
        "0r47h303356123435632b313l33971313n93gj|a44325233345464",                                                   // Sasquatch #14
        "0r71321233d21335321233d213713573d7039743578fc|818322353344526",                                            // Puzzle #1
        "n4b036530717365b9336t33653139336b1393f939383939383p38357938z|c9183939495568667975888",                     // Thinking_Rabbit #6
        "cfj533l33l33m33m33l33m33m33l33l33l33l335jfc|81d1333532444641535552646662848681939592a4a6a1b3b5b",          // Sasquatch #18
        "gfg353n1233l233da33d673d630v0|934624363244425354536",                                                      // Sasquatch #20
        "j0v039b12d303ha13577531ah303d21b930v0j|fd3a14262b23383a344",                                               // Sasquatch #21
        "gjcg39788bd74839397083h357n1317533653p336lj365jcns|e18627254769657",                                       // Puzzle #2
    ];

function getHex(pos) {
    return '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWX@&%#+-*/=$|~.,:;!?^_()[]<>{}'.indexOf(pos);
}

function getCanvas(height) {
    var local = mechanizedAbbreviation(new canvas(canvas_w * sprite_w, height)),
        style = local.cs.style;
    doc_main.appendChild(local.cs);
    style.position = 'absolute';
    style.top = 0;
    style.left = 0;
    return local;
}

//=========================
// mechanized abbreviation
//=========================
// see http://marijnhaverbeke.nl/js1k/

function mechanizedAbbreviation(object) {
    for (tmp in object) {
        object[tmp[0] + (tmp[5]||'')] = object[tmp];
    }
    return object;
}

//==================
// main_init_canvas
//==================

main_init_canvas = function (create) {

    if (create) {

        //doc_main.setAttribute('style', 'height:' + (canvas_h * sprite_h + 24) + 'px');
    doc_main.setAttribute('style', 'width:' + (canvas_w * sprite_w) + 'px;height:' + (canvas_h * sprite_h + 24) + 'px;position:relative;');
        // Screen zone
        displayzone = getCanvas(canvas_h * sprite_h + 24);
        // Ground
        displaygnd = getCanvas(canvas_h * sprite_h);
        // Shadows
        displaysha = getCanvas(canvas_h * sprite_h);
        // Map
        displaymap = getCanvas(canvas_h * sprite_h);
        // Objects
        displayobj = getCanvas(canvas_h * sprite_h);

    } else {
        picture[2].d(displayzone, 0, 0);
        displaygnd.c();
        displaysha.c();
        displaymap.c();
        displayobj.c();
    }

};

//====================
// main_number_format
//====================

main_number_format = function (number, length) {
    return ('000' + number).slice(-length);
};

//=================
// game_controller
//=================

game_controller = function (add) {

    current_move = 0;
    current_push = 0;
    current_level += add;

    if (current_level < 1) {
        current_level = 1;
    }
    if (current_level > levels_length) {
        current_level = levels_length;
    }

    game_init_level(levels[current_level - 1]);
    main_init_canvas(0);

    game_display_map();
    statusbar_game();

};

//=================
// game_init_level
//=================

game_init_level = function (levelData) {

    var i, j, box;

    map = levelData.m;
    map_width = levelData.w;
    map_height = levelData.h;

    map_obj = [];
    for (j = 0; j < map_height; j++) {
        map_obj[j] = [];
        for (i = 0; i < map_width; i++) {
            map_obj[j][i] = 0;
        }
    }

    box = levelData.b;
    for (i = 0; i < box.length; i++) {
        map_obj[box[i][1]][box[i][0]] = 1;
    }

    pos_x = levelData.p[0];
    pos_y = levelData.p[1];

};

//=================
// game_next_level
//=================

game_next_level = function () {

    if (current_level == levels_length) {
        current_level = 0;
        game_controller(0);
    } else {
        game_controller(1);
    }

};

//==================
// game_display_map
//==================

game_display_map = function (/* var */ i, j, elt) {
    for (j = 0; j < map_height; j++) {
        for (i = 0; i < map_width; i++) {
            elt = map[j][i];
            // Ground
            if (elt == 1 || elt == 2) {
                sprite_draw(displaygnd, elt, i, j);
            // Walls
            } else if (elt == 3) {
                sprite_draw(displaymap, elt, i, j);
            }
            // Boxes
            if (map_obj[j][i] == 1) {
                if (map_is_destination(i, j)) {
                    sprite_draw(displayobj, 5, i, j);
                } else {
                    sprite_draw(displayobj, 4, i, j);
                }
            }
        }
    }
    // display character
    sprite_draw(displayobj, 6, pos_x, pos_y);
};

//================
// game_direction
//================

game_direction = function (dx, dy) {
    // Move sprite
    sprite_direction(dx, dy);
    // Check end of game
    if (map_check_end_of_game()) {
        modal_view();
    }
};

//=======================
// map_check_end_of_game
//=======================

map_check_end_of_game = function (/* var */ x, y) {
    for (y = 0; y < map_height; y++) {
        for (x = 0; x < map_width ; x++) {
            if (map_is_box(x, y) && (!map_is_destination(x, y))) {
                return false;
            }
        }
    }
    return true;
};

//============
// map_is_box
//============

map_is_box = function (x, y) {
    return (map_obj[y][x] == 1);
};

//==============
// map_is_empty
//==============

map_is_empty = function (x, y) {
    return (
        // Vide ou destination
        (map[y][x] == 1 || map_is_destination(x, y))
        // Pas de boite
        && (!map_is_box(x, y))
    );
};

//====================
// map_is_destination
//====================

map_is_destination = function (x, y) {
    return (map[y][x] == 2);
};

//=============
// sprite_draw
//=============
    
sprite_draw = function (layer, num, x, y) {
    var decal_x = (sprite_w / 2) * (canvas_w - map_width),
        decal_y = (sprite_h / 2) * (canvas_h - map_height),
        dest_x = decal_x + (x * sprite_w),
        dest_y = decal_y + (y * sprite_h);
    if (num == 0) {
        layer.cx.clearRect(dest_x, dest_y, sprite_w, sprite_h);
        displaysha.cx.clearRect(dest_x + shadow_w, dest_y + shadow_w, sprite_w, sprite_h);
    } else {
        num--;
        picture[1].da(
            layer,
            dest_x,
            dest_y,
            (num % 3) * sprite_w,
            ((num / 3)|0) * sprite_h,
            sprite_w,
            sprite_h
        );
        // Wall or Box : Drop shadow
        if (2 <= num && num <= 4) {
            displaysha.q(dest_x + shadow_w, dest_y + shadow_w, sprite_w, sprite_h, 'rgba(0,0,0,0.3)');
        }
    }
};

//==================
// sprite_direction
//==================

sprite_direction = function (dx, dy) {
    if (map_is_empty(pos_x + dx, pos_y + dy)) {
        sprite_move(dx, dy);
    } else if (map_is_box(pos_x + dx, pos_y + dy) && map_is_empty(pos_x + 2 * dx, pos_y + 2 * dy)) {
        sprite_push_or_pull(+1, dx, dy);
    }
};

//=============
// sprite_move
//=============

sprite_move = function (dx, dy) {
    // Remove character at current position
    sprite_draw(displayobj, 0, pos_x, pos_y);
    // Update position
    pos_x += dx;
    pos_y += dy;
    // Display at new position
    sprite_draw(displayobj, 6, pos_x, pos_y);
    // Inc move counter
    current_move++;
    // Refresh status bar
    statusbar_game();
};

//=====================
// sprite_push_or_pull
//=====================

sprite_push_or_pull = function (type, dx, dy) {
    var mult;
    // Update position (PULL)
    if (type == -1) {
        sprite_move(-dx, -dy);
    }
    // Remove box at old position
    mult = (type == 1) ? 1 : 2;
    sprite_draw(displayobj, 0, pos_x + mult * dx, pos_y + mult * dy);
    map_obj[pos_y + mult * dy][pos_x + mult * dx] = 0;
    // Display at new position
    mult = (type == 1) ? 2 : 1;
    if (map_is_destination(pos_x + mult * dx, pos_y + mult * dy)) {
        sprite_draw(displayobj, 5, pos_x + mult * dx, pos_y + mult * dy);
    } else {
        sprite_draw(displayobj, 4, pos_x + mult * dx, pos_y + mult * dy);
    }
    map_obj[pos_y + mult * dy][pos_x + mult * dx] = 1;
    // Update position (PUSH)
    if (type == 1) {
        sprite_move(dx, dy);
    }
    // Inc push counter
    current_push++;
    // Refresh status bar
    statusbar_game();
};

//================
// statusbar_game
//================

statusbar_game = function () {

    displayzone.q(0, 577, canvas_w * sprite_w, 23, '#000');

    picture[3].p(
        displayzone,
        'Level ' + main_number_format(current_level, 2) + ' / ' + main_number_format(levels_length, 2) +
            '    Moves ' + main_number_format(current_move, 4) +
            '    Pushes ' + main_number_format(current_push, 4) +
            '    (R)estart (N)ext',
        152,
        582
    );

};

//===============
// unpack_levels
//===============

unpack_levels = function () {

    var packed_map, packed_pos, idx, str,
        map, width, box, perso,
        i, j, k, l, m, pos, nb, val;

    for (k = 0; k < levels_length; k++) {

        idx = levels[k].indexOf('|');

        // Packed strings
        packed_map = levels[k].slice(0, idx);
        packed_pos = levels[k].slice(idx + 1);

        // Unpack map width
        width = getHex(packed_pos[0]);

        // Unpack character position
        perso = [getHex(packed_pos[1]), getHex(packed_pos[2])];

        // Unpack boxes position
        box = [];
        m = 0;
        str = packed_pos.slice(3);
        for (l = 0; l < str.length; l += 2) {
            i = getHex(str[l]);
            j = getHex(str[l + 1]);
            box[m++] = [i, j];
        }

        // Unpack map
        map = [];
        map[0] = [];
        i = 0;
        j = 0;
        for (l = 0; l < packed_map.length; l++) {
            pos = getHex(packed_map[l]);
            nb = (pos / 4) | 0;
            val = pos - nb * 4;
            for (m = 0; m <= nb ; m++) {
                map[j][i++] = val;
                if (i >= width) {
                    i = 0;
                    j++;
                    map[j] = [];
                }
            }
        }

        // Create unpacked version of map object
        levels[k] = {
            w: width,
            h: j,
            m: map,
            b: box,
            p: perso
        };

    }

};

//============
// modal_view
//============

modal_view = function () {

    displayobj.q(240, 230, canvas_w * sprite_w - 480, canvas_h * sprite_h - 460, '#000');

    picture[3].p(displayobj, "LEVEL " + main_number_format(current_level, 2) + " COMPLETE", 332, 260);
    picture[3].p(displayobj, "Press N", 372, 300);

    allow_move = 0;

};

//===============
// main function
//===============

function init() {

    doc = document;
    doc_main = doc.getElementById("main");
    
	var d1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAJYCAMAAACtqHJCAAAABlBMVEUA/wAAAABvA35DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF7GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTA0LTA2VDAxOjAzOjI5KzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wNC0wNlQwMjowNTozOSswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wNC0wNlQwMjowNTozOSswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjIiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkNzBiMTViZC0wNjhkLTk1NDEtOGYwNS0yYTZjMGY5NzUyOTUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Y2M3YjJkY2QtNjkwMi01MjRiLWIyZjQtZTg5NjA2OGY0MGQ2IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6Y2M3YjJkY2QtNjkwMi01MjRiLWIyZjQtZTg5NjA2OGY0MGQ2Ij4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjYzdiMmRjZC02OTAyLTUyNGItYjJmNC1lODk2MDY4ZjQwZDYiIHN0RXZ0OndoZW49IjIwMjEtMDQtMDZUMDE6MDM6MjkrMDk6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZDcwYjE1YmQtMDY4ZC05NTQxLThmMDUtMmE2YzBmOTc1Mjk1IiBzdEV2dDp3aGVuPSIyMDIxLTA0LTA2VDAyOjA1OjM5KzA5OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+lWnlogAAHNVJREFUeJzt3eea6joShWFrzr7/W9b8aOi2UilYoSR/735mTgNOgJbLCcuYC0DK/1YvAKAZAQEEBAQQEBBAQEAAAQEBBAQEEBAQQEBAAAEBAQQEBBAQEEBAQAABAQEEBAQQEBBAQEAAAQEBBAQEEBAQQEBAAAEBAQQEBBAQEEBAQAABAQEEBAQQEBBAQEAAAQEBBAQEEBAQQEBAAAEBAQQEBBAQEEBAQADBv9ULcATrPS7uOrh5xIdWzXc/ZsxH43wBJvmK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";
	
	var d2 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABACAMAAADS6oI8AAAAG1BMVEUAAP8AAIAA/wD//wCAgAD///+AgIAAAAD///8r5OclAAAACXRSTlP//////////wBTT3gSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF7GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTA0LTA2VDAxOjAzOjI5KzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wNC0wNlQwMToyMzozNiswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wNC0wNlQwMToyMzozNiswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjIiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkNzllYjdjZi1mOTNkLTUwNGEtYmIzNi1iMDFmMzg5ZDQ1NTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Yjk3YzVlMWEtZDUyOC0xNjQ0LThjNGUtNzRmYjAxZWQyY2E4IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6Yjk3YzVlMWEtZDUyOC0xNjQ0LThjNGUtNzRmYjAxZWQyY2E4Ij4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpiOTdjNWUxYS1kNTI4LTE2NDQtOGM0ZS03NGZiMDFlZDJjYTgiIHN0RXZ0OndoZW49IjIwMjEtMDQtMDZUMDE6MDM6MjkrMDk6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE4IChXaW5kb3dzKSIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZDc5ZWI3Y2YtZjkzZC01MDRhLWJiMzYtYjAxZjM4OWQ0NTU5IiBzdEV2dDp3aGVuPSIyMDIxLTA0LTA2VDAxOjIzOjM2KzA5OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+lIJ7zQAAAWdJREFUWIXtWNFyhCAM3BRk7v8/V2vpA7SnLckaxel1hvigN5nbZSGLQZlgxzvJJ5KPEDOfkc28IIt1IZIBABAA2bhn65I3TsAHYF0dCEwFPQhsBQfWwJp/quD+NQjBLlN8VBA075BA2F9hDYYPblYwfDB8cF3B8AFTMHxQyIYPSPyxDw5WkY7OqijC7p43FXkuH8kIwPIsIjlhMIV1/HMjlSqAiSAAViMfdHzMqRKwSeaT1MSvDD0UKPiFoYMCFR+YEyLKKa6RLYc4YA1raKkIa1iDiQ/MqYOT7fj/BAfeB78jNwpjApbW8xkFbPfaxSuugUuAiyBnP75nkTOQ6+I2zL8ozw4FpYv46ieOhmeKtv3KLQQV2YXvrCJx43vLVDT8n5/+vn97faCNf9kzTJe2Cs7wxD+32VGGjRH6Eezs9YzbNzt5XG68rJdy6tG2JJ2hT9uiM/RqvDSGfq1jm6E0v/Lgf78Un612FThNcV+sAAAAAElFTkSuQmCC";
	
	var d3 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAJYCAMAAACtqHJCAAAABlBMVEWAgIAAAADnaKu+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIxLTA0LTA2VDAxOjAzOjI5KzA5OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMS0wNC0wNlQwMToyMzoxMSswOTowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMS0wNC0wNlQwMToyMzoxMSswOTowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjIiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1w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";
	
	var d4 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAACMAQMAAADRI7y6AAAABlBMVEUAAAD///+l2Z/dAAAAAXRSTlMAQObYZgAAAexJREFUOI2F1DuO4zAMBmAdQAdQ4UOwTDHFHsUH2MIlC1V7MlauiC2DFC5ygMEgpQoi2J96xINJ4lWTL4YkUqTsECj4oIjfzpQePE0PUjxm+MHwxH2zsIcIkcLBiExsnUY2qIumvtOghbRRokYaRJhPoj531kYKBM7aKN9oVkM42Yx9zZ7Lr4FkJ2PuZOtZneQaValRBrmUxNZoljhXXqKStsp8o0WdtdWjcqIWwmbjxsIzL0cF40CFb2bZq4CApWanwVQ3EXEqRmUKaqKlbJWlkzBXMEF/sC3zQjm38dRDiFV6YOE3iSlOJKty4UHPTCle5Mu37vx0GsWb3Hee7TEBtM510+JEWqBcOrXSbDWEQGZq7GTJbzIrGdtjGQ6BlAZVqDINcuW10rthC3gmZzlVEu7KZQLv7EQnlUHp/FLniltMqxJCrAWr/1QeDQnxkChp7lXP3u9GlFi1P93p/ewT1Fv7RLNxnUMuOb+r2RSEkizOj52ErPCvMpclKf3Ga4INF7yad+yL6lIqdEc65LzRebDsvDQaqCgVmJXTX0Y/8TkBV5D9gocyehjC7WWi9MSSR8PbYRv9cnsT2SnXnez9pMqp9rOy9hMfJsMN+/B+ZuwrZcroZwwyWmM7S/jvsJdMR4fxMb/k681ejn+lEN56iEPEMAAAAABJRU5ErkJggg==";
	
    // Load images
        picture[0] = mechanizedAbbreviation(new image(d1));
		picture[1] = mechanizedAbbreviation(new image(d2));
		picture[2] = mechanizedAbbreviation(new image(d3));
		picture[3] = mechanizedAbbreviation(new image(d4));

    picture[0].i.onload = function() {
        picture[0].d(displayzone, 0, 0);
    }

    picture[3].ii(8, 14, 32);

    unpack_levels();

    doc.onkeydown = function(event) {
        var key = event.which || event.keyCode;
        if (allow_move && key == 40) {          // Down
            game_direction(0, 1);
            event.preventDefault();
            return false;
        } else if (allow_move && key == 38) {   // Up
            game_direction(0, -1);
            event.preventDefault();
            return false;
        } else if (allow_move && key == 37) {   // Left
            game_direction(-1, 0);
            event.preventDefault();
            return false;
        } else if (allow_move && key == 39) {   // Right
            game_direction(1, 0);
            event.preventDefault();
            return false;
        } else if (key == 78) {                 // (N)ext
            allow_move = 1;
            game_next_level();
        } else if (key == 82) {                 // (R)estart
            allow_move = 1;
            game_controller(0);
        }
    };

    main_init_canvas(1);

};


</script>
<style type="text/css"> 
      body {
        margin: 0;
        padding: 0;
        font-family: Helvetica;
      }
	canvas {
		  image-rendering: optimizeSpeed;             /* Older versions of FF          */
		  image-rendering: -moz-crisp-edges;          /* FF 6.0+                       */
		  image-rendering: -webkit-optimize-contrast; /* Safari                        */
		  image-rendering: -o-crisp-edges;            /* OS X & Windows Opera (12.02+) */
		  image-rendering: pixelated;                 /* Awesome future-browsers       */
		  -ms-interpolation-mode: nearest-neighbor;   /* IE                            */
	}

    </style> 
</head> 
<body  onload="init();" bgcolor="#000">
<br>
<center>
<div id="main"></div>
</center>
</body>
</html>
